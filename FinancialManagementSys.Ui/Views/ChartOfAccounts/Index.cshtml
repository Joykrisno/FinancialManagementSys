@{
    ViewData["Title"] = "Chart of Accounts";
}

<h2>Chart of Accounts</h2>

<table id="accountsTable" class="display table table-bordered table-striped" style="width:100%">
    <thead>
        <tr>
            <th>Account Code</th>
            <th>Account Name</th>
            <th>Type</th>
            <th>Opening Balance</th>
            <th>Current Balance</th>
            <th>Action</th>
        </tr>
    </thead>
</table>

@section Scripts {
    <script>
        $(document).ready(function () {
            if (!$.fn.DataTable) {
                console.error("DataTables is not loaded!");
                return;
            }

            $('#accountsTable').DataTable({
                "ajax": {
                    "url": '@Url.Action("GetAccounts", "ChartOfAccounts")',
                    "type": "GET",
                    "datatype": "json",
                    "error": function(xhr) { console.error("AJAX error:", xhr.responseText); }
                },
                "columns": [
                    { "data": "accountCode" },
                    { "data": "accountName" },
                    { "data": "accountType" },
                    { "data": "openingBalance" },
                    { "data": "currentBalance" },
                    {
                        "data": "id",
                        "render": function(data) {
                            return `<a href='/ChartOfAccounts/Details/${data}'>Details</a> |
                                    <a href='/ChartOfAccounts/Edit/${data}'>Edit</a> |
                                    <a href='/ChartOfAccounts/Delete/${data}'>Delete</a>`;
                        },
                        "orderable": false
                    }
                ]
            });
        });
    </script>
}
